# 离散傅里叶变换 (DFT) 核心架构笔记

## 一、 物理本质：从“时间”到“圆周”的投影

**核心思想：** DFT 是将长度为 $N$ 的时域序列 $x[n]$，投影到一组**正交的复指数基函数**上。

- **输入：** $N$ 维向量 $\vec{x} = [x_0, x_1, \dots, x_{N-1}]^T$（时域采样点）。
    
- **基向量：** 频率为 $k$ 的标准旋转向量 $\vec{v}_k = [e^{j\frac{2\pi}{N}k \cdot 0}, e^{j\frac{2\pi}{N}k \cdot 1}, \dots, e^{j\frac{2\pi}{N}k \cdot (N-1)}]^T$。
    
    - $k$ 的含义：在 $N$ 个采样点的时间跨度内，圆周运动完整转过的圈数。
        
- **操作（内积）：**
    
    $$ X[k] = \langle \vec{x}, \vec{v}_k \rangle = \sum_{n=0}^{N-1} x[n] \cdot e^{-j\frac{2\pi}{N}kn}$$
    
    - **为什么用负号？** 因为内积定义要求对基向量取**复共轭**。
        
    - **物理意义：** $X[k]$ 的大小代表了原始信号中含有频率 $k$ 的“成分”有多少。
        

---

## 二、 关键特性：离散世界的规则

### 1. 频率分辨率 (Resolution)

- **公式：** $\Delta f = \frac{f_s}{N}$ （$f_s$ 为采样率，$N$ 为点数）。
    
- **直觉：** 采样总时间 $T = N/f_s$ 决定了你能看多细。采样 1 秒，分辨率就是 $1\text{ Hz}$；采样 2 秒，分辨率提升到 $0.5\text{ Hz}$。
    

### 2. 频谱泄露 (Leakage)

- **现象：** 当信号频率不是 $\Delta f$ 的整数倍时，能量会散布到相邻的 $k$ 桶中。
    
- **本质：** DFT 假设信号是周期循环的。若频率不匹配，首尾衔接处会出现**相位断层（不连续性）**，这种瞬间跳变在频域产生高频杂波。
    
- **对策：** **加窗 (Windowing)**。通过将信号首尾压低至 0，平滑断层，牺牲主峰宽度来换取更干净的频谱。
    

### 3. 共轭对称性

- 对于实信号，$X[k]$ 与 $X[N-k]$ 是复共轭关系。
    
- **物理结论：** 只有前 $N/2$ 个点是有独立物理意义的正频率，后半部分是镜像。
    

---

## 三、 算法加速：FFT 的分治逻辑

**核心思想：** 利用旋转因子 $W_N^{kn} = e^{-j\frac{2\pi}{N}kn}$ 的**对称性**，将 $O(N^2)$ 的任务拆解为 $O(N \log N)$。

### 1. 奇偶拆分 (Cooley-Tukey 算法)

将 $N$ 点 DFT 拆分为两个 $N/2$ 点 DFT：

$$ X[k] = E[k] + W_N^k \cdot O[k]$$

- $E[k]$：偶数下标项的 DFT。
    
- $O[k]$：奇数下标项的 DFT。
    

### 2. 蝴蝶操作 (Butterfly Operation)

利用 $W_N^{k+N/2} = -W_N^k$ 的特性，计算一次 $E[k]$ 和 $O[k]$ 可以同时得到两个输出：

1. $X[k] = E[k] + W_N^k O[k]$
    
2. $X[k+N/2] = E[k] - W_N^k O[k]$
    
    这使得计算量减半，每一层只需做 $N/2$ 次复数乘法。
    

### 3. 实现步骤：倒位序排序 (Bit-Reversal)

为了让最底层的两个元素（如 $x[0]$ 和 $x[4]$）在内存中相邻以便进行蝴蝶合并，必须先对原始索引进行二进制反转排序：

- $1 (001_2) \leftrightarrow 4 (100_2)$
    
- $3 (011_2) \leftrightarrow 6 (110_2)$